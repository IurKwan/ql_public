/**
 * 望潮 APP
 * 先点击阅读有礼，完成任务并绑定支付宝账号
 * 抓https://xmt.taizhou.com.cn/prod-api/user-read/app/login
 * 把 id # sessionId # deviceId 填到wangchao中，多账号用&添加
 */


const _0x2f46=['crypto','get','&sessionId=','json','结束=listUserArticle','*/*',';\x20tfstk=','xmt.taizhou.com.cn','&signature=','阅读文章成功=','浏览器运行环境','srv-app.taizhou.com.cn','createHash','已经阅读=','Mozilla/5.0\x20(Linux;\x20Android\x2013;\x20LE2110\x20Build/TP1A.220905.001;\x20wv)\x20AppleWebKit/537.36\x20(KHTML,\x20like\x20Gecko)\x20Version/4.0\x20Chrome/103.0.5060.129\x20Mobile\x20Safari/537.36;xsb_wangchao;xsb_wangchao;6.0.2;native_app;6.10.0','isRead','getTime','same-origin','https://xmt.taizhou.com.cn/prod-api/already-read/article?articid=','https://xmt.taizhou.com.cn/readingLuck-v1/','https://srv-app.taizhou.com.cn',';\x20JSESSIONID=','default','split','抽奖失败：','awardName',']开始运行','got','env','document','https://xmt.taizhou.com.cn/prod-api/user-read/app/login?id=','empty','抽奖活动完成=','code','en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7','getDate','digest','https://xmt.taizhou.com.cn/prod-api/user-read/list/','finally','https://srv-app.taizhou.com.cn/luckdraw-ra-1/','entries','getMonth','com.shangc.tiennews.taizhou','活动登录成功','保存失败：','update','match','log','keep-alive','cookie=','message','cors','规则错误','undefined','&deviceId='];const _0x5600=function(_0x2f469c,_0x560060){_0x2f469c=_0x2f469c-0x0;let _0x147169=_0x2f46[_0x2f469c];return _0x147169;};let wangchao=process[_0x5600('0x1c')]['wangchao'];let userList=[];let articles=[];let JSESSIONID='';let ACTIVITY_JSESSIONID='';main()['catch'](()=>{})[_0x5600('0x26')](()=>{});async function main(){await loadDependencies();if(!await checkEnv())return;console['log']('\x0a望潮每日抽奖');for(const [_0x218747,_0x35046d]of userList[_0x5600('0x28')]()){console[_0x5600('0x2f')]('账号['+(_0x218747+0x1)+_0x5600('0x1a'));await login(_0x35046d);await listUserArticle(_0x35046d);if(!articles){return;}let _0x5dd42d=!![];for(const _0x28db5a of articles){_0x5dd42d=_0x5dd42d&&_0x28db5a[_0x5600('0xf')];}if(!_0x5dd42d){for(const _0x3b088e of articles){await readArticle(_0x3b088e,_0x35046d);console['log']('等待5秒');await delay(0x1388);}}await activityLogin(_0x35046d);if(!ACTIVITY_JSESSIONID){return;}await finishActivity(_0x35046d);await userAwardRecordUpgrade(_0x35046d);}}async function login(_0x301b46){const _0x5ca401=_0x5600('0x1e')+_0x301b46[0x0]+_0x5600('0x2')+_0x301b46[0x1]+_0x5600('0x36')+_0x301b46[0x2];const _0x4bff08=await got[_0x5600('0x1')](_0x5ca401,{'headers':{'Host':'xmt.taizhou.com.cn','Connection':'keep-alive','User-Agent':'Mozilla/5.0\x20(Linux;\x20Android\x2013;\x20LE2110\x20Build/TP1A.220905.001;\x20wv)\x20AppleWebKit/537.36\x20(KHTML,\x20like\x20Gecko)\x20Version/4.0\x20Chrome/103.0.5060.129\x20Mobile\x20Safari/537.36;xsb_wangchao;xsb_wangchao;6.0.2;native_app;6.10.0','Accept':'*/*','X-Requested-With':'com.shangc.tiennews.taizhou','Sec-Fetch-Site':_0x5600('0x11'),'Sec-Fetch-Mode':_0x5600('0x33'),'Sec-Fetch-Dest':_0x5600('0x1f'),'Referer':_0x5600('0x13'),'Accept-Language':'en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7'}});const _0x28525e=parseJSESSIONID(_0x4bff08['rawHeaders']);if(!_0x28525e){console['log']('获取JSESSIONID失败');return;}JSESSIONID=_0x28525e;}async function listUserArticle(_0x2f9478){if(!JSESSIONID){console[_0x5600('0x2f')](_0x5600('0x4'));return;}const _0x5d8a06=_0x5600('0x25')+getFormattedDate();const _0x4b8310=await got[_0x5600('0x1')](_0x5d8a06,{'headers':{'Host':'xmt.taizhou.com.cn','Connection':_0x5600('0x30'),'User-Agent':'Mozilla/5.0\x20(Linux;\x20Android\x2013;\x20LE2110\x20Build/TP1A.220905.001;\x20wv)\x20AppleWebKit/537.36\x20(KHTML,\x20like\x20Gecko)\x20Version/4.0\x20Chrome/103.0.5060.129\x20Mobile\x20Safari/537.36;xsb_wangchao;xsb_wangchao;6.0.2;native_app;6.10.0','Accept':'*/*','X-Requested-With':'com.shangc.tiennews.taizhou','Sec-Fetch-Site':'same-origin','Sec-Fetch-Mode':'cors','Sec-Fetch-Dest':_0x5600('0x1f'),'Referer':_0x5600('0x13'),'Accept-Language':_0x5600('0x22'),'Cookie':_0x5600('0x31')+_0x2f9478[0x3]+_0x5600('0x6')+_0x2f9478[0x4]+_0x5600('0x15')+JSESSIONID}})[_0x5600('0x3')]();if(_0x4b8310[_0x5600('0x21')]!==0xc8){console[_0x5600('0x2f')]('请求文章列表失败：'+_0x4b8310[_0x5600('0x32')]);return;}articles=_0x4b8310['data']['articleIsReadList'];console[_0x5600('0x2f')]('请求文章列表成功');}async function readArticle(_0x3d7022,_0x28f188){if(_0x3d7022[_0x5600('0xf')]===!![]){console['log'](_0x5600('0xd')+_0x3d7022['title']);return;}const _0x440415=new Date()[_0x5600('0x10')]();const _0x1093e3=_0x5600('0x12')+_0x3d7022['id']+'&timestamp='+_0x440415+_0x5600('0x8')+signature(_0x3d7022['id'],_0x440415);const _0x1ed745=await got['get'](_0x1093e3,{'headers':{'Host':_0x5600('0x7'),'Connection':'keep-alive','User-Agent':'Mozilla/5.0\x20(Linux;\x20Android\x2013;\x20LE2110\x20Build/TP1A.220905.001;\x20wv)\x20AppleWebKit/537.36\x20(KHTML,\x20like\x20Gecko)\x20Version/4.0\x20Chrome/103.0.5060.129\x20Mobile\x20Safari/537.36;xsb_wangchao;xsb_wangchao;6.0.2;native_app;6.10.0','Accept':_0x5600('0x5'),'X-Requested-With':_0x5600('0x2a'),'Sec-Fetch-Site':'same-origin','Sec-Fetch-Mode':'cors','Sec-Fetch-Dest':'empty','Referer':'https://xmt.taizhou.com.cn/readingLuck-v1/','Accept-Language':_0x5600('0x22'),'Cookie':_0x5600('0x31')+_0x28f188[0x3]+';\x20tfstk='+_0x28f188[0x4]+_0x5600('0x15')+JSESSIONID}})['json']();if(_0x1ed745['code']!==0xc8){console['log']('阅读文章失败：'+_0x1ed745['message']);return;}console[_0x5600('0x2f')](_0x5600('0x9')+_0x3d7022['title']);}async function activityLogin(_0x23e62c){const _0x4b1935='https://srv-app.taizhou.com.cn/tzrb/user/loginWC?accountId='+_0x23e62c[0x0]+_0x5600('0x2')+_0x23e62c[0x1];const _0x44c519=await got[_0x5600('0x1')](_0x4b1935,{'headers':{'Host':_0x5600('0xb'),'Connection':'keep-alive','User-Agent':_0x5600('0xe'),'Accept':'*/*','X-Requested-With':_0x5600('0x2a'),'Sec-Fetch-Site':'same-origin','Sec-Fetch-Mode':'cors','Sec-Fetch-Dest':_0x5600('0x1f'),'Referer':_0x5600('0x27'),'Accept-Language':_0x5600('0x22')}});const _0x1b8964=parseActivitySession(_0x44c519['rawHeaders']);if(!_0x1b8964){console[_0x5600('0x2f')]('活动登录失败：'+_0x44c519['message']);return;}ACTIVITY_JSESSIONID=_0x1b8964;console['log'](_0x5600('0x2b'));}async function finishActivity(_0x4df7cf){const _0xbcea61='https://srv-app.taizhou.com.cn/tzrb/userAwardRecordUpgrade/saveUpdate';const _0x45a870=await got['post'](_0xbcea61,{'headers':{'Host':'srv-app.taizhou.com.cn','Connection':'keep-alive','User-Agent':'Mozilla/5.0\x20(Linux;\x20Android\x2013;\x20LE2110\x20Build/TP1A.220905.001;\x20wv)\x20AppleWebKit/537.36\x20(KHTML,\x20like\x20Gecko)\x20Version/4.0\x20Chrome/103.0.5060.129\x20Mobile\x20Safari/537.36;xsb_wangchao;xsb_wangchao;6.0.2;native_app;6.10.0','Accept':_0x5600('0x5'),'Origin':_0x5600('0x14'),'X-Requested-With':'com.shangc.tiennews.taizhou','Sec-Fetch-Site':'same-origin','Sec-Fetch-Mode':_0x5600('0x33'),'Sec-Fetch-Dest':_0x5600('0x1f'),'Referer':_0x5600('0x27'),'Accept-Language':'en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7','Cookie':'JSESSIONID='+ACTIVITY_JSESSIONID+_0x5600('0x6')+_0x4df7cf[0x4]+'.','Content-type':'application/x-www-form-urlencoded'},'form':{'activityId':'67','sessionId':'undefined','sig':'undefined','token':_0x5600('0x35')}})['json']();if(_0x45a870[_0x5600('0x21')]!==0xc8){console['log'](_0x5600('0x2c')+_0x45a870[_0x5600('0x32')]);return;}console[_0x5600('0x2f')]('保存活动成功');}async function userAwardRecordUpgrade(_0x1af173){const _0x2fa763='https://srv-app.taizhou.com.cn/tzrb/userAwardRecordUpgrade/pageList?pageSize=10&pageNum=1&activityId=67';const _0x1ee319=await got[_0x5600('0x1')](_0x2fa763,{'headers':{'Host':'srv-app.taizhou.com.cn','Connection':_0x5600('0x30'),'User-Agent':_0x5600('0xe'),'Accept':_0x5600('0x5'),'X-Requested-With':_0x5600('0x2a'),'Sec-Fetch-Site':'same-origin','Sec-Fetch-Mode':_0x5600('0x33'),'Sec-Fetch-Dest':'empty','Referer':_0x5600('0x27'),'Accept-Language':'en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7','Cookie':'JSESSIONID='+ACTIVITY_JSESSIONID+';\x20tfstk='+_0x1af173[0x4]+'.'}})[_0x5600('0x3')]();if(_0x1ee319[_0x5600('0x21')]!==0xc8){console['log'](_0x5600('0x18')+_0x1ee319['message']);return;}console[_0x5600('0x2f')](_0x5600('0x20')+_0x1ee319['data']['records'][0x0][_0x5600('0x19')]);}function getFormattedDate(){const _0x1e61e8=new Date();const _0x2e42c2=_0x1e61e8['getFullYear']();let _0x15f3ce=_0x1e61e8[_0x5600('0x29')]()+0x1;_0x15f3ce=_0x15f3ce<0xa?'0'+_0x15f3ce:_0x15f3ce;let _0x3f2f78=_0x1e61e8[_0x5600('0x23')]();_0x3f2f78=_0x3f2f78<0xa?'0'+_0x3f2f78:_0x3f2f78;return''+_0x2e42c2+_0x15f3ce+_0x3f2f78;}async function checkEnv(){if(!wangchao){console['log']('找不到wangchao');return![];}const _0x5ef47d=wangchao['split']('&');for(const [_0x313a51,_0x5bc961]of _0x5ef47d[_0x5600('0x28')]()){const _0x30962f=_0x5bc961[_0x5600('0x17')]('#');if(_0x30962f['length']!==0x3){console['log']('账号'+(_0x313a51+0x1)+_0x5600('0x34'));return![];}userList['push'](_0x30962f);}return!![];}function parseJSESSIONID(_0x19ff76){const _0xd8e435={};for(let _0x736879=0x0;_0x736879<_0x19ff76['length'];_0x736879+=0x2){_0xd8e435[_0x19ff76[_0x736879]]=_0x19ff76[_0x736879+0x1];}const _0x1ab4e4=_0xd8e435['Set-Cookie'];let _0x580147=null;if(_0x1ab4e4){const _0x40bdf9=_0x1ab4e4[_0x5600('0x2e')](/JSESSIONID=([^;]+)/);if(_0x40bdf9){_0x580147=_0x40bdf9[0x1];}}return _0x580147;}function signature(_0x2c408e,_0x11c5ae){const _0x8c3bd1='&&'+_0x2c408e+'&&TlGFQAOlCIVxnKopQnW&&'+_0x11c5ae;return crypto[_0x5600('0xc')]('md5')[_0x5600('0x2d')](_0x8c3bd1)[_0x5600('0x24')]('hex');}function delay(_0x316c05){return new Promise(_0x5dfaa2=>setTimeout(_0x5dfaa2,_0x316c05));}function parseActivitySession(_0x5c8e1c){for(let _0x325f11=0x0;_0x325f11<_0x5c8e1c['length'];_0x325f11+=0x2){if(_0x5c8e1c[_0x325f11]==='Set-Cookie'){const _0x1bfaa6=_0x5c8e1c[_0x325f11+0x1];const _0x1997b0=_0x1bfaa6['match'](/JSESSIONID=([^;]+)/);if(_0x1997b0){return _0x1997b0[0x1];}}}}async function loadDependencies(){if(typeof window!==_0x5600('0x35')&&typeof window[_0x5600('0x1d')]!==_0x5600('0x35')){console[_0x5600('0x2f')](_0x5600('0xa'));const _0x3adca4=await import('got');const _0x18428a=await import(_0x5600('0x0'));window[_0x5600('0x1b')]=_0x3adca4[_0x5600('0x16')];window[_0x5600('0x0')]=_0x18428a['default'];}else{console[_0x5600('0x2f')]('其他运行环境');const _0x5f2cf6=await import('got');const _0x3a3fdb=await import('crypto');global['got']=_0x5f2cf6['default'];global['crypto']=_0x3a3fdb['default'];}}
